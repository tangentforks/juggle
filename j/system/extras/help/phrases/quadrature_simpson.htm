<html>
<head>
<title>Quadrature &amp; Simpson's Rule</title>
<LINK REL=stylesheet HREF="../jdoc.css" TYPE="text/css">
</head><body><!--top jump start--><a href="geometry.htm">&gt&gt;</a>&nbsp;
<a href="trans_functions.htm">&lt&lt;</a>&nbsp;
<a href="../index/a.htm">Ndx</a>&nbsp;
<a href="../user/contents.htm">Usr</a>&nbsp;
<a href="../primer/contents.htm">Pri</a>&nbsp;
<a href="../phrases/contents.htm">Phr</a>&nbsp;
<a href="../dictionary/contents.htm">Dic</a>&nbsp;
<a href="../release/contents.htm">Rel</a>&nbsp;
<a href="../dictionary/vocabul.htm">Voc</a>&nbsp;
<a href="../dictionary/xmain.htm">!:</a>&nbsp;
<a href="../user/win_driver_cmd_ref_overview.htm">wd</a>&nbsp;
<a href="../index.htm">Help</a>&nbsp;
Phrases<hr><!--top jump end-->




<TR valign="baseline"><TD><H1>Quadrature And Simpson's Rule</h1>
<TR><TD colspan="2"> 

<TABLE BORDER="0" WIDTH="500"><TR><TD>
<TABLE ALIGN="center" BORDER="1" CELLSPACING="0" CELLPADDING="0" WIDTH="100%">
  <TR><TD><TT>m0=: W=: integ p. +: &gt;. 1:</TT></TD>	<TD>Weights for 1+2*y points; try m0 3x</TD></TR>
  <TR><TD><TT>m1=: integ=: pint"1@%.@vm</TT></TD>	<TD>Integral of inverse of Vandermonde</TD></TR>
  <TR><TD><TT>m2=: vm=: ^~/~@i.@&gt;:@+:</TT></TD>	<TD>Transposed Vm of order 1+2*y</TD></TR>
  <TR><TD><TT>m3=: pint=: 0: , ] % &gt;:@i.@#</TT></TD>	<TD>Polynomial integral of coefficients y</TD></TR>
  <TR><TD><TT>m4=: pder=: 1: }. ] * i.@#</TT></TD>	<TD>Polynomial derivative of coefficients y</TD></TR>
  <TR><TD><TT>d5=: EW=: +/@(-@take {."0 1 ])</TT></TD>	<TD>Extended weights (x groups of #y points)</TD></TR>
  <TR><TD><TT>d6=: take=:i.@[ (] + &lt;:@] * [) #@]</TT></TD>	<TD>Amounts of overtake</TD></TR>
</TABLE>


<P>The integral of a function <TT>f</TT> from <TT>a </TT>to <TT>b </TT>is called its <I>quadrature</I>. Quadrature can be approximated by a weighted sum of the values of the function on a uniform grid from <TT><TT>a </TT></TT>to <TT>b</TT>. Use of the weights <TT>(1 4 1)%3</TT> on a grid of three points is equivalent to integrating the parabola (polynomial of order 2) fitted to the function at the points. Use of these weights is referred to as an application of <I>Simpson's Rule</I>.</P>

<P>The foregoing phrases  (based on the development in <I>Calculus </I>[7]) provide the weights for Simpson's Rule and for higher-order polynomial approximations as illustrated below:</P></TD></TR></TABLE>

 
<PRE>   ,.(W 1x);(W 2x);(W 3x)
+---------------------------------------------+
&brvbar;1r3 4r3 1r3                                  &brvbar;
+---------------------------------------------&brvbar;
&brvbar;14r45 64r45 8r15 64r45 14r45                 &brvbar;
+---------------------------------------------&brvbar;
&brvbar;41r140 54r35 27r140 68r35 27r140 54r35 41r140&brvbar;
+---------------------------------------------+

   ,.(3*W 1x);(45*W 2x);(140*W 3x)
+-----------------------+
&brvbar;1 4 1                  &brvbar;
+-----------------------&brvbar;
&brvbar;14 64 24 64 14         &brvbar;
+-----------------------&brvbar;
&brvbar;41 216 27 272 27 216 41&brvbar;
+-----------------------+</PRE>

<TABLE BORDER="0" WIDTH="500"><TR><TD><P>If weights for <TT>n </TT>points are applied by dividing the grid into groups of n points, the weights are applied as illustrated below for four groups of Simpson's Rule:</P></TD></TR></TABLE>

<PRE>   (-3 5 7 9) {."0 1 w=: 1 4 1
1 4 1 0 0 0 0 0 0
0 0 1 4 1 0 0 0 0
0 0 0 0 1 4 1 0 0
0 0 0 0 0 0 1 4 1

   +/(-3 5 7 9) {."0 1 w
1 4 2 4 2 4 2 4 1</PRE>

<TABLE BORDER="0" WIDTH="500"><TR><TD><P>The function <TT>EW </TT>provides such extended weights as illustrated below:</P></TD></TR></TABLE>

<PRE>   3 * 5 EW W 1
1 4 2 4 2 4 2 4 2 4 1

   45 * 4 EW W 2
14 64 24 64 28 64 24 64 28 64 24 64 28 64 24 64 14</PRE>



</TD>
  </tr>
<TR><TD>
<!--bottom jump start--><hr><a href="geometry.htm">&gt&gt;</a>&nbsp;
<a href="trans_functions.htm">&lt&lt;</a>&nbsp;
<a href="../index/a.htm">Ndx</a>&nbsp;
<a href="../user/contents.htm">Usr</a>&nbsp;
<a href="../primer/contents.htm">Pri</a>&nbsp;
<a href="../phrases/contents.htm">Phr</a>&nbsp;
<a href="../dictionary/contents.htm">Dic</a>&nbsp;
<a href="../release/contents.htm">Rel</a>&nbsp;
<a href="../dictionary/vocabul.htm">Voc</a>&nbsp;
<a href="../dictionary/xmain.htm">!:</a>&nbsp;
<a href="../user/win_driver_cmd_ref_overview.htm">wd</a>&nbsp;
<a href="../index.htm">Help</a>&nbsp;
Phrases<!--bottom jump end--></td></tr></table></body>
</html>
